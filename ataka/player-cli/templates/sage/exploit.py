#!/usr/bin/env python3

from sage.all import *

import os
import json
import time
import random
import string

from pwn import *

from Crypto.Util.number import long_to_bytes, bytes_to_long

s2b = lambda x: x if isinstance(x, bytes) else x.encode() if isinstance(x, str) else repr(x).encode()
b2s = lambda x: x if isinstance(x, str) else x.decode() if isinstance(x, bytes) else repr(x)
h2b = lambda x: bytes.fromhex(x)
b2h = lambda x: x.hex()
h2l = lambda x: int(x, 16)
l2h = lambda x: hex(x)[2:]
l2b = lambda x: long_to_bytes(x)
b2l = lambda x: bytes_to_long(x)
s2h = lambda x: b2h(s2b(x))
s2l = lambda x: b2l(s2b(x))
h2s = lambda x: b2s(h2b(x))
l2s = lambda x: b2s(l2b(x))


"""
print bytes as ...
"""
p4s = lambda x: print(b2s(x))
p4b = lambda x: print(s2b(x))
p4h = lambda x: print(b2h(x))
p4l = lambda x: print(b2l(x))

from Crypto.Cipher import AES
"""
AES copy paste
# CBC encrypt
cipher = AES.new(key, AES.MODE_CBC)
ct = cipher.encrypt(pad(pt, AES.block_size))
iv = cipher.iv

# CBC decrypt
cipher = AES.new(key, AES.MODE_CBC, iv)
ct = unpad(cipher.decrypt(pt))
"""

from pwnlib.util.fiddling import b64d, b64e, xor
"""
data_enc = b64e(data)
data_dec = b64d(data_enc)
xor together bytes with xor
"""

F = GF(2)
a, b = F(1), F(1)
print(a + b)

# Work around rate limits
# time.sleep(random.uniform(0, 10))
# Remember to sleep at least 1s between subsequent TCP connections within this exploit

### HELPERS ###
def gen_random(n):
    return ''.join(random.choice(string.ascii_lowercase + string.ascii_uppercase) for i in range(n))

useragent = random.choice([
    "python-requests/2.28.0",
    "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:98.0) Gecko/20100101 Firefox/98.0",
    "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.88 Safari/537.36",
    "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.63 Safari/537.36",
    "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36",
    "Mozilla/5.0 (X11; Linux x86_64; rv:100.0) Gecko/20100101 Firefox/100.0",
    "Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0",
    "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36",
    "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.0.0 Safari/537.36",
    "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:100.0) Gecko/20100101 Firefox/100.0",
])

# Pick what you need. some examples given here
headers = {'User-Agent': useragent,
           'Accept-Language': 'en-US,en;q=0.5',
           'Content-Type': 'application/x-www-form-urlencoded',
           'Upgrade-Insecure-Requests': '1'}

### END HELPERS ###

HOST = os.getenv('TARGET_IP')
EXTRA = json.loads(os.getenv('TARGET_EXTRA', '[]'))

print('ECSC_AAAAAAAAABBBBBBBBCCCCCCCDDDDDDDD')
